{"ast":null,"code":"import { getEmployees, getTransactionsPaginated, getTransactionsByEmployee, setTransactionApproval } from \"./requests\";\nconst timeout = getTimeout();\nconst mockTimeout = 1 * timeout;\nexport function fakeFetch(endpoint, params) {\n  return new Promise((resolve, reject) => {\n    mockApiLogger({\n      message: \"Loading request\",\n      data: {\n        endpoint,\n        params\n      },\n      type: \"info\"\n    });\n    let result;\n\n    try {\n      switch (endpoint) {\n        case \"employees\":\n          result = getEmployees();\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout);\n          break;\n\n        case \"paginatedTransactions\":\n          result = getTransactionsPaginated(params);\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout * 2.5);\n          break;\n\n        case \"transactionsByEmployee\":\n          result = getTransactionsByEmployee(params);\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout * 1.5);\n          break;\n\n        case \"setTransactionApproval\":\n          result = setTransactionApproval(params);\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout * 1);\n          break;\n\n        default:\n          throw new Error(\"Invalid endpoint\");\n      }\n    } catch (error) {\n      if (error instanceof Error) {\n        mockApiLogger({\n          message: error.message,\n          data: {\n            endpoint,\n            params\n          },\n          type: \"error\"\n        });\n        reject(error.message);\n      }\n    }\n  });\n}\n\nfunction mockApiLogger(_ref) {\n  let {\n    data,\n    message = \"Success request\",\n    type = \"success\"\n  } = _ref;\n\n  if (process.env.REACT_APP_MOCK_REQUEST_LOGS_ENABLED === \"false\") {\n    return;\n  }\n\n  console.log(`%c--Fake Request Debugger-- %c${message}`, \"color: #717171\", getTitleColor());\n  console.log(data);\n\n  function getTitleColor() {\n    if (type === \"error\") {\n      return \"color: #d93e3e;\";\n    }\n\n    if (type === \"info\") {\n      return \"color: #1670d2;\";\n    }\n\n    return \"color: #548a54;\";\n  }\n}\n\nfunction getTimeout() {\n  var _ref2, _URL$searchParams$get;\n\n  const timeout = parseInt((_ref2 = (_URL$searchParams$get = new URL(document.location).searchParams.get(\"timeout\")) !== null && _URL$searchParams$get !== void 0 ? _URL$searchParams$get : process.env.REACT_APP_TIMEOUT_MULTIPLIER) !== null && _ref2 !== void 0 ? _ref2 : \"1000\");\n\n  if (Number.isNaN(timeout)) {\n    return 1000;\n  }\n\n  return timeout;\n}","map":{"version":3,"names":["getEmployees","getTransactionsPaginated","getTransactionsByEmployee","setTransactionApproval","timeout","getTimeout","mockTimeout","fakeFetch","endpoint","params","Promise","resolve","reject","mockApiLogger","message","data","type","result","setTimeout","Error","error","process","env","REACT_APP_MOCK_REQUEST_LOGS_ENABLED","console","log","getTitleColor","parseInt","URL","document","location","searchParams","get","REACT_APP_TIMEOUT_MULTIPLIER","Number","isNaN"],"sources":["/Users/richie/Desktop/ramp-fe-challenge 2/src/utils/fetch.ts"],"sourcesContent":["import {\n  getEmployees,\n  getTransactionsPaginated,\n  getTransactionsByEmployee,\n  setTransactionApproval,\n} from \"./requests\"\nimport { PaginatedRequestParams, RequestByEmployeeParams, SetTransactionApprovalParams } from \"./types\"\n\nconst timeout = getTimeout()\nconst mockTimeout = 1 * timeout\n\nexport function fakeFetch<TData, TParams extends object = object>(\n  endpoint: RegisteredEndpoints,\n  params?: TParams\n): Promise<TData> {\n  return new Promise((resolve, reject) => {\n    mockApiLogger({\n      message: \"Loading request\",\n      data: { endpoint, params },\n      type: \"info\",\n    })\n\n    let result: TData\n\n    try {\n      switch (endpoint) {\n        case \"employees\":\n          result = getEmployees() as unknown as TData\n\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout)\n          break\n\n        case \"paginatedTransactions\":\n          result = getTransactionsPaginated(params as PaginatedRequestParams) as unknown as TData\n\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout * 2.5)\n          break\n\n        case \"transactionsByEmployee\":\n          result = getTransactionsByEmployee(params as RequestByEmployeeParams) as unknown as TData\n\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout * 1.5)\n          break\n\n        case \"setTransactionApproval\":\n          result = setTransactionApproval(params as SetTransactionApprovalParams) as unknown as TData\n\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout * 1)\n          break\n\n        default:\n          throw new Error(\"Invalid endpoint\")\n      }\n    } catch (error) {\n      if (error instanceof Error) {\n        mockApiLogger({\n          message: error.message,\n          data: { endpoint, params },\n          type: \"error\",\n        })\n        reject(error.message)\n      }\n    }\n  })\n}\n\nfunction mockApiLogger({\n  data,\n  message = \"Success request\",\n  type = \"success\",\n}: {\n  message?: string\n  data: object\n  type?: \"success\" | \"error\" | \"info\"\n}) {\n  if (process.env.REACT_APP_MOCK_REQUEST_LOGS_ENABLED === \"false\") {\n    return\n  }\n\n  console.log(`%c--Fake Request Debugger-- %c${message}`, \"color: #717171\", getTitleColor())\n  console.log(data)\n\n  function getTitleColor() {\n    if (type === \"error\") {\n      return \"color: #d93e3e;\"\n    }\n\n    if (type === \"info\") {\n      return \"color: #1670d2;\"\n    }\n\n    return \"color: #548a54;\"\n  }\n}\n\nfunction getTimeout() {\n  const timeout = parseInt(\n    new URL(document.location as unknown as URL).searchParams.get(\"timeout\") ??\n      process.env.REACT_APP_TIMEOUT_MULTIPLIER ??\n      \"1000\"\n  )\n\n  if (Number.isNaN(timeout)) {\n    return 1000\n  }\n\n  return timeout\n}\n\nexport type RegisteredEndpoints =\n  | \"employees\"\n  | \"paginatedTransactions\"\n  | \"transactionsByEmployee\"\n  | \"setTransactionApproval\"\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}